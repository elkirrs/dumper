import{_ as u}from"./RestoreDatabase-D1GBujTy.js";import{_ as f}from"./YamlViewer-EYd3OhGe.js";import{_ as m}from"./List-9IzYe8wZ.js";import{_ as y}from"./Chip-r3g9xEU9.js";import{_ as b,c as h,a as e,t as i,b as s,w as l,F as v,o as k,d as o}from"./index-D3bEWYKG.js";import{V as n}from"./VAlert-D8DYbunK.js";import"./VSlideGroup-CkGCFVJU.js";const _={components:{RestoreDatabase:u},data(){return{driver:"elastic",database:"Elastic Search",utility:["curl"],snackbar:!1,configKeys:[{key:"title",value:"Human-readable database name",type:"string",required:!1,info:{text:"",link:""}},{key:"name",value:"Database name (repository name)",type:"string",required:!0,info:{text:"",link:""}},{key:"user",value:"Database user's name (for auth)",type:"string",required:!1,info:{text:"required if set password",link:""}},{key:"password",value:"Database user's password (for auth)",type:"string",required:!1,info:{text:"required if set user",link:""}},{key:"token",value:"Database token (for auth)",type:"string",required:!1,info:{text:"",link:""}},{key:"server",value:"The link to the server from the servers section list",type:"string",required:!0,info:{text:"",link:""}},{key:"driver",value:"Driver database",type:"string",required:!0,info:{text:"",link:""}},{key:"format",value:"Database dump format",type:"string",required:!0,info:{text:'Format list: "tar"',link:""}},{key:"remove_dump",value:"Remove dump file after created (default true)",type:"boolean",required:!1,info:{text:"",link:""}},{key:"storages",value:"Storage list when the dump need to upload",type:"array",required:!0,info:{text:"(Not required if storage set up in global setting)",link:""}},{key:"encrypt",value:"Encrypt database",type:"object",required:!1,info:{text:"",link:"#/crypt/database"}},{key:"shell",value:"Run shell scrypt",type:"object",required:!1,info:{text:"",link:"#/shell"}},{key:"docker",value:"Create dump in docker",type:"object",required:!1,info:{text:"",link:"#/docker"}},{key:"options",value:"Additional options for the database",type:"object",required:!1,info:{text:"",link:""},sub:[{key:"source",value:"Full path to dump util",type:"string",required:!1},{key:"ca_crt_path",value:"Path to file a CA that elasticsearch trusts",type:"string",required:!1},{key:"crt_path",value:"Path to file client certificate",type:"string",required:!1},{key:"key_path",value:"Path to file private key",type:"string",required:!1},{key:"key_pass",value:"Password for key proivate",type:"string",required:!1},{key:"snap_path",value:"Path to snapshot dir",type:"string",required:!1,info:{text:"Default set from dir_remote"}},{key:"indices",value:"Create the dump include only indexes from this list",type:"array",required:!1},{key:"ignore_unavailable",value:"Allows you to take a snapshot, even if some indexes are missing or unavailable.",type:"bool",required:!1,info:{text:"Default value: false"}},{key:"include_global_state",value:"Determines whether to include the global cluster state in the snapshot",type:"bool",required:!1,info:{text:"Default value: false"}}]},{key:"dir_remote",value:"Dir remote for dumps",type:"string",required:!1,info:{text:'default value from global settings (if the default value is not set, then "./" is used.)',link:""}}],yamlConfig:[],restoreDatabase:[{title:"Use this command to restore database",value:'$ curl -X POST "http://localhost:9200/_snapshot/my-repository/snap_2/_restore"'}]}},computed:{configBase(){return{title:"Elastic Search DB",name:"testks",driver:this.driver,server:"srv-elasticsearch",format:"tar",storages:["sftp","local"],remove_dump:!0,dir_remote:"/opt/elasticsearch-backups"}}},mounted(){this.yamlConfig=[{title:"Default",value:{databases:{elasticsearch_db:{...this.configBase}}}},{title:"archive",value:{databases:{elasticsearch_db:{...this.configBase,archive:!0}}}},{title:"docker",value:{databases:{elasticsearch_db:{...this.configBase,docker:{enabled:!0,command:"docker compose --file /var/www/docker-compose.yaml exec -T elasticsearch"}}}}},{title:"shell",value:{databases:{elasticsearch_db:{...this.configBase,shell:{enabled:!0,after:"command runs after create dump",before:"command runs before create dump"}}}}},{title:"encrypt",value:{databases:{elasticsearch_db:{...this.configBase,encrypt:{enabled:!0,type:"aes",password:"123456"}}}}},{title:"All",value:{databases:{elasticsearch_db:{...this.configBase,archive:!0,docker:{enabled:!0,command:"docker compose --file /var/www/docker-compose.yaml exec -T elasticsearch"},shell:{enabled:!0,after:"command runs after create dump",before:"command runs before create dump"},encrypt:{enabled:!0,type:"aes",password:"123456"}}}}},{title:"disabled",value:{databases:{elasticsearch_db:{...this.configBase,archive:!1,docker:{enabled:!1},shell:{enabled:!1},encrypt:{enabled:!1}}}}}]}},g={class:"pb-5"},x={class:"pb-5"},q={class:"pb-5"},w={class:"pb-5"},D={class:"pb-5"},B={class:"pb-5"};function C(T,t,j,P,a,V){const r=y,d=m,c=f,p=u;return k(),h(v,null,[e("div",g,[e("h2",null,i(a.database),1)]),e("div",x,[s(n,{border:"start",variant:"text",density:"compact"},{default:l(()=>[e("p",null,[t[0]||(t[0]=o(" Dumper uses ",-1)),s(r,{items:a.utility},null,8,["items"]),o(" utility to backup "+i(a.database)+" database. ",1)]),t[1]||(t[1]=e("p",null,"The first step is to install the utility to create a database dump for your env.",-1)),t[2]||(t[2]=e("p",null,"The final backup file will always be archived.",-1))]),_:1})]),e("div",q,[s(n,{variant:"text",type:"warning",density:"compact"},{default:l(()=>[...t[3]||(t[3]=[e("p",null," If you are using docker, you must have a backup path similar to the path to the server.",-1)])]),_:1})]),e("div",w,[t[4]||(t[4]=e("h2",null,"Config keys",-1)),s(r,{items:["driver: "+a.driver]},null,8,["items"]),s(d,{items:a.configKeys},null,8,["items"])]),e("div",D,[s(c,{configObject:a.yamlConfig},null,8,["configObject"])]),e("div",B,[s(p,{items:a.restoreDatabase},null,8,["items"])])],64)}const K=b(_,[["render",C]]);export{K as default};
